<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Energy-Based Models for Grasp Planning | Ebrahim Rasromani </title> <meta name="author" content="Ebrahim Rasromani"> <meta name="description" content="Bridging the gap between grasp sampling, evaluation, and refinement."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://erasromani.github.io/projects/3_project/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Ebrahim</span> Rasromani </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Energy-Based Models for Grasp Planning</h1> <p class="post-description">Bridging the gap between grasp sampling, evaluation, and refinement.</p> </header> <article> <h2 id="abstract">Abstract</h2> <p>State-of-the-art grasp planning techniques typically use a two-stage approach: a <strong>grasp generator</strong> network proposes candidate grasps, and a <strong>grasp evaluator</strong> network estimates the probability of success. However, these two stages act independently — no backpropagation occurs between them. This disjointed structure limits performance and consistency.</p> <p>This project explores how <strong>energy-based models (EBMs)</strong> can unify grasp generation, evaluation, and refinement within a single differentiable framework. Given a scene, a grasp can be generated, evaluated, and refined in <em>one shot</em> by descending along the energy manifold. Trained contrastively on ~200,000 examples from DexNet 2.0 using a <strong>noise-contrastive estimation (NCE)</strong> loss, the model learns to assign low energy to successful grasps and high energy to unsuccessful ones.</p> <p>Results suggest the EBM generalizes to novel scenes, differentiates good from bad grasps, and produces viable grasp candidates — all within a single integrated system.</p> <hr> <h2 id="motivation">Motivation</h2> <p>Grasping is one of the core unsolved problems in robotics. Despite progress from deep learning, grasp planning techniques often rely on disjoint modules for sampling and evaluation. These separate modules prevent gradient flow and limit adaptability.</p> <p>By contrast, energy-based models represent grasp quality as a <strong>continuous energy landscape</strong>, where high-quality grasps correspond to <strong>low-energy regions</strong>. This formulation enables optimization-based refinement — grasp candidates can be iteratively improved by <em>descending the energy manifold</em> toward local minima.</p> <p>This work demonstrates how EBMs can unify the grasping pipeline — generating, evaluating, and refining grasps in a fully differentiable loop.</p> <figure align="center"> <img src="https://erasromani.github.io/ebm-grasp-planning/images/two-stage-approach.png" alt="two-stage-approach" style="width:80%;height:auto;"> <figcaption>Figure 1: The traditional two-stage grasp planning approach, in which grasp sampling and evaluation are separate (image adapted from Mousavian et al. [2]).</figcaption> </figure> <hr> <h2 id="method">Method</h2> <p>An energy-based model defines a scalar energy (E(x, y)) over depth image (x) and grasp configuration (y). Positive samples (successful grasps) are assigned low energy, while negative samples (failed grasps) are assigned high energy.</p> <p>During inference, grasps are initialized randomly and refined by <strong>gradient descent</strong> on (E(x, y)), yielding improved candidates that converge to local minima on the manifold. The NCE loss is used for training:</p> \[L = \frac{1}{n^+} \sum_{i=1}^{n^+} \ell_i\] \[\ell_i = \frac{E_w(x_i, y_i)}{\tau} + \log \left[ \exp\left(\frac{-E_w(x_i, y_i)}{\tau}\right) + \sum_{j=1}^{n^-} \exp\left(\frac{-E_w(x_j, \hat{y}_j)}{\tau}\right) \right]\] <p>where (\tau) is a temperature hyperparameter controlling the sharpness of the energy separation.</p> <figure align="center"> <img src="https://erasromani.github.io/ebm-grasp-planning/images/ebm-inference.png" alt="ebm-inference" style="width:80%;height:auto;"> <figcaption>Figure 2: EBMs unify grasp sampling, evaluation, and refinement by descending the energy manifold.</figcaption> </figure> <hr> <h2 id="experiment-setup">Experiment Setup</h2> <p>A subset of <strong>220,000 examples</strong> from the <strong>DexNet 2.0</strong> dataset was used for training and validation. DexNet 2.0 contains 6.7 million synthetic depth images and grasps generated from 1,500 3D object models. Each grasp is represented by a 4D vector: center row, center column, depth, and binary success label.</p> <figure align="center"> <img src="https://erasromani.github.io/ebm-grasp-planning/images/dexnet-2.0.png" alt="dexnet-2.0" style="width:80%;height:auto;"> <figcaption>Figure 3: Sample from DexNet 2.0 showing grasp quality annotations [1].</figcaption> </figure> <p>The network consists of a convolutional encoder for depth features and a fully connected energy head. The grasp vector is repeated and concatenated with visual features before entering the MLP, which outputs a scalar energy.</p> <figure align="center"> <img src="https://erasromani.github.io/ebm-grasp-planning/images/network.png" alt="network" style="width:400px;height:auto;"> <figcaption>Figure 4: Network architecture for the energy-based model.</figcaption> </figure> <p>The model was trained with batch size 512, learning rate 1e-4, and temperature (\tau \in {1, 10, 100, 1000}). An <em>alignment metric</em> was monitored — the percentage of positive samples with energy lower than any negative sample in the batch.</p> <hr> <h2 id="results">Results</h2> <p>Training for 500 epochs across temperature values revealed that (\tau = 100) achieved the best alignment (86.8%). Higher temperatures improve stability by widening the energy separation between positives and negatives.</p> <figure align="center"> <img src="https://erasromani.github.io/ebm-grasp-planning/images/training-curves.png" alt="training-curves" style="width:80%;height:auto;"> <figcaption>Figure 5: Training curves across temperature values.</figcaption> </figure> <figure align="center"> <img src="https://erasromani.github.io/ebm-grasp-planning/images/energy-distribution.png" alt="energy-distribution" style="width:80%;height:auto;"> <figcaption>Figure 6: Validation energy distributions show separation between successful (low-energy) and failed (high-energy) grasps.</figcaption> </figure> <figure align="center"> <img src="https://erasromani.github.io/ebm-grasp-planning/images/high-vs-low-energy.png" alt="high-vs-low-energy" style="width:80%;height:auto;"> <figcaption>Figure 7: Visual comparison of low-energy (successful) and high-energy (failed) grasp samples.</figcaption> </figure> <p>The energy contours (Figures 8–9) illustrate local minima around successful grasps, confirming that the EBM learns a smooth manifold corresponding to grasp quality.</p> <figure align="center"> <img src="https://erasromani.github.io/ebm-grasp-planning/images/inference-example.png" alt="inference-example" style="width:60%;height:auto;"> <figcaption>Figure 8: Example depth image and grasp pair used for inference visualization.</figcaption> </figure> <figure align="center"> <img src="https://erasromani.github.io/ebm-grasp-planning/images/energy-contours.png" alt="energy-contours" style="width:80%;height:auto;"> <figcaption>Figure 9: Energy manifold contours centered around a high-quality grasp region.</figcaption> </figure> <hr> <h2 id="grasp-generation-in-action">Grasp Generation in Action</h2> <p>The video below shows examples of grasps refined by gradient descent over the learned energy manifold. Starting from random initializations, the grasps converge to valid configurations.</p> <video style="display:block; margin: 0 auto;" width="480" height="320" controls=""> <source type="video/mp4" src="https://erasromani.github.io/ebm-grasp-planning/videos/videos_combined.mp4"></source> </video> <hr> <h2 id="conclusion">Conclusion</h2> <p>Energy-based models offer a powerful unifying framework for grasp planning. By embedding sampling, evaluation, and refinement into a single differentiable process, the EBM bridges the gap between current two-stage approaches. The trained model generalizes to unseen objects, differentiates grasp quality, and generates physically plausible grasps via energy descent.</p> <p>Future work includes deploying this model in full 3D simulation and coupling it with a learned grasp success predictor for closed-loop control.</p> <hr> <h2 id="references">References</h2> <ol> <li>Mahler, J. <em>et al.</em>, “Dex-Net 2.0: Deep Learning to Plan Robust Grasps with Synthetic Point Clouds and Analytic Grasp Metrics.” RSS, 2017.</li> <li>Mousavian, A., Eppner, C., and Fox, D., “6-DOF GraspNet: Variational Grasp Generation for Object Manipulation.” ICCV, 2019.</li> <li>Murali, A. <em>et al.</em>, “6-DOF Grasping for Target-driven Object Manipulation in Clutter.” ICRA, 2020.</li> <li>LeCun, Y. <em>et al.</em>, “A Tutorial on Energy-based Learning.” MIT Press, 2007.</li> <li>Gutmann, M. and Hyvӓrinen, A., “Noise-contrastive estimation: A new estimation principle for unnormalized statistical models.” AISTATS, 2010.</li> <li>Misra, I. and van der Maaten, L., “Self-supervised learning of pretext-invariant representations.” arXiv:1912.01991, 2019.</li> <li>Chen, T., Kornblith, S., Norouzi, M., and Hinton, G., “A Simple Framework for Contrastive Learning of Visual Representation.” ICML, 2020.</li> </ol> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Ebrahim Rasromani. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>